import{c as rt,a as i,f as h,t as Dt,s as w,d as It}from"../chunks/CMVsHYcO.js";import{p as kt,l as H,c as Mt,o as st,d,f as r,g as t,u as y,r as e,t as q,s as $t,a as Rt,b as X,e as Wt,$ as Yt}from"../chunks/Dzkio-oR.js";import{h as zt,e as Kt,s as Z}from"../chunks/BMajUMua.js";import{i as et}from"../chunks/BsUrrD3l.js";import{c as D}from"../chunks/BcPhfkvl.js";import{C as St,a as Ct,b as Tt,c as Pt,d as Ot,S as qt,A as wt,e as Jt,f as Qt,T as Ut,l as Vt,t as Xt}from"../chunks/f84GbuiW.js";import{b as Et,c as mt,S as Bt,g as Lt}from"../chunks/DzaD3Cwb.js";import{m as Zt,S as tt}from"../chunks/BRmNWpY2.js";import{S as te}from"../chunks/DCGNGnMU.js";import{N as ee,l as re}from"../chunks/BCWT7tJj.js";var ae=h('<div class="text-sm text-muted-foreground">No mood entries found for the selected criteria</div>'),oe=h('<div class="flex items-start justify-between"><div><div class="text-sm font-medium text-muted-foreground">Best Day</div> <div class="mt-1 text-lg font-semibold"> </div></div> <div class="text-right"><div class="text-2xl font-bold text-green-600"> </div> <div class="text-xs text-muted-foreground">avg mood</div></div></div>'),se=h('<div class="flex items-start justify-between border-t border-border pt-4"><div><div class="text-sm font-medium text-muted-foreground">Worst Day</div> <div class="mt-1 text-lg font-semibold"> </div></div> <div class="text-right"><div class="text-2xl font-bold text-red-600"> </div> <div class="text-xs text-muted-foreground">avg mood</div></div></div>'),ne=h('<div class="flex items-start justify-between border-t border-border pt-4"><div><div class="text-sm font-medium text-muted-foreground">Most Common Context</div> <div class="mt-1 flex items-center gap-2"><!> <span class="text-lg font-semibold"> </span></div></div> <div class="text-right"><div class="text-2xl font-bold text-[#485e92]"> </div> <div class="text-xs text-muted-foreground"> </div></div></div>'),de=h('<div class="grid gap-4"><!> <!> <!></div>'),ie=h("<!> <!>",1);function le(nt,N){kt(N,!0);const a=y(()=>{if(N.entries.length===0)return{bestDay:null,worstDay:null,mostCommonTag:null};const p=Et(N.entries),G=mt(p);let T=G[0],A=G[0];G.forEach(c=>{c.averageMood>T.averageMood&&(T=c),c.averageMood<A.averageMood&&(A=c)});const k=new Bt;N.entries.forEach(c=>{c.labels.forEach(b=>{const P=k.get(b.id);P?P.count++:k.set(b.id,{name:b.name,icon:b.icon,count:1})})});let $=null;return k.forEach(c=>{(!$||c.count>$.count)&&($=c)}),{bestDay:T,worstDay:A,mostCommonTag:$}});function L(p){return p.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}function C(p){return p>0?`+${p.toFixed(1)}`:p.toFixed(1)}var j=rt(),J=H(j);D(J,()=>Pt,(p,G)=>{G(p,{class:"w-full",children:(T,A)=>{var k=ie(),$=H(k);D($,()=>St,(b,P)=>{P(b,{children:(I,at)=>{var R=rt(),Q=H(R);D(Q,()=>Ct,(o,s)=>{s(o,{class:"text-2xl",children:(n,g)=>{st();var l=Dt("Highlights");i(n,l)},$$slots:{default:!0}})}),i(I,R)},$$slots:{default:!0}})});var c=d($,2);D(c,()=>Tt,(b,P)=>{P(b,{children:(I,at)=>{var R=rt(),Q=H(R);{var o=n=>{var g=ae();i(n,g)},s=n=>{var g=de(),l=r(g);{var W=x=>{var u=oe(),m=r(u),_=d(r(m),2),M=r(_,!0);e(_),e(m);var v=d(m,2),f=r(v),E=r(f,!0);e(f),st(2),e(v),e(u),q((F,B)=>{w(M,F),w(E,B)},[()=>L(t(a).bestDay.date),()=>C(t(a).bestDay.averageMood)]),i(x,u)};et(l,x=>{t(a).bestDay&&x(W)})}var Y=d(l,2);{var z=x=>{var u=se(),m=r(u),_=d(r(m),2),M=r(_,!0);e(_),e(m);var v=d(m,2),f=r(v),E=r(f,!0);e(f),st(2),e(v),e(u),q((F,B)=>{w(M,F),w(E,B)},[()=>L(t(a).worstDay.date),()=>C(t(a).worstDay.averageMood)]),i(x,u)};et(Y,x=>{t(a).worstDay&&x(z)})}var K=d(Y,2);{var O=x=>{const u=y(()=>Lt(t(a).mostCommonTag.icon));var m=ne(),_=r(m),M=d(r(_),2),v=r(M);D(v,()=>t(u),(it,gt)=>{gt(it,{class:"h-5 w-5",strokeWidth:2})});var f=d(v,2),E=r(f,!0);e(f),e(M),e(_);var F=d(_,2),B=r(F),dt=r(B,!0);e(B);var ot=d(B,2),ft=r(ot,!0);e(ot),e(F),e(m),q(()=>{w(E,t(a).mostCommonTag.name),w(dt,t(a).mostCommonTag.count),w(ft,t(a).mostCommonTag.count===1?"entry":"entries")}),i(x,m)};et(K,x=>{t(a).mostCommonTag&&x(O)})}e(g),i(n,g)};et(Q,n=>{N.entries.length===0?n(o):n(s,!1)})}i(I,R)},$$slots:{default:!0}})}),i(T,k)},$$slots:{default:!0}})}),i(nt,j),Mt()}var ve=h('<button type="button"><!> <span> </span></button>'),ce=h('<div class="rounded-lg border border-border/50 bg-background px-3 py-2 text-xs shadow-xl"><div class="font-medium"> </div> <div class="mt-1 flex items-center gap-2"><div class="h-2 w-2 rounded-full bg-[#485e92]"></div> <span class="text-muted-foreground"> </span></div> <div class="mt-0.5 text-[10px] text-muted-foreground"> </div></div>'),ue=h("<!> <!> <!> <!>",1),me=h('<div class="h-[300px] w-full"><!></div>'),fe=h('<div class="flex h-[300px] w-full items-center justify-center text-sm text-muted-foreground">No mood entries found for the selected criteria</div>'),ge=h("<!> <!>",1),xe=h('<div class="flex h-screen flex-col bg-white"><main class="flex flex-1 flex-col gap-6 overflow-y-auto px-4 py-4"><div class="flex flex-wrap gap-2 py-2"><button type="button">Week</button> <button type="button">Month</button> <button type="button">3 Months</button> <button type="button">Year</button></div> <div class="flex flex-wrap gap-2"></div> <!> <!></main> <!></div>');function Se(nt,N){kt(N,!0);let a=$t("3months"),L=$t(Rt(new Set));const C=y(()=>{const o=new Date,s=new tt(o);s.setHours(23,59,59,999);const n=new tt(o);switch(t(a)){case"week":n.setDate(o.getDate()-7);break;case"month":n.setMonth(o.getMonth()-1);break;case"3months":n.setMonth(o.getMonth()-3);break;case"year":n.setFullYear(o.getFullYear()-1);break}return n.setHours(0,0,0,0),{start:n,end:s}}),j=y(()=>Zt.allEntries.filter(o=>o.date>=t(C).start&&o.date<=t(C).end?t(L).size===0?!0:o.labels.some(n=>t(L).has(n.id)):!1)),J=y(()=>{if(t(j).length===0)return[];if(t(a)==="week"||t(a)==="month"){const s=Et(t(j));return mt(s)}else{const s=new Bt;return t(j).forEach(n=>{const g=new tt(n.date);g.setDate(n.date.getDate()-n.date.getDay()),g.setHours(0,0,0,0);const l=g.toISOString().split("T")[0];s.has(l)||s.set(l,[]),s.get(l).push(n)}),mt(s)}}),p=y(()=>t(J).length===0?[t(C).start,t(C).end]:[t(C).start,t(C).end]);function G(o){const s=new te(t(L));s.has(o)?s.delete(o):s.add(o),X(L,s,!0)}var T=xe();zt("u6zn5i",o=>{Wt(()=>{Yt.title="Insights - MoodLog"})});var A=r(T),k=r(A),$=r(k);$.__click=()=>X(a,"week");var c=d($,2);c.__click=()=>X(a,"month");var b=d(c,2);b.__click=()=>X(a,"3months");var P=d(b,2);P.__click=()=>X(a,"year"),e(k);var I=d(k,2);Kt(I,21,()=>re.all,o=>o.id,(o,s)=>{const n=y(()=>Lt(t(s).icon)),g=y(()=>t(L).has(t(s).id));var l=ve();l.__click=()=>G(t(s).id);var W=r(l);D(W,()=>t(n),(K,O)=>{O(K,{class:"h-4 w-4",strokeWidth:2})});var Y=d(W,2),z=r(Y,!0);e(Y),e(l),q(()=>{Z(l,1,`flex items-center gap-2 rounded-lg border border-[#c5c6d0] px-3 py-1.5 text-sm font-medium transition-colors ${t(g)?"bg-[#d9dff6] text-[#404659]":"bg-white text-[#44464f] hover:bg-gray-50"}`),w(z,t(s).name)}),i(o,l)}),e(I);var at=d(I,2);le(at,{get entries(){return t(j)}});var R=d(at,2);D(R,()=>Pt,(o,s)=>{s(o,{class:"w-full",children:(n,g)=>{var l=ge(),W=H(l);D(W,()=>St,(z,K)=>{K(z,{children:(O,x)=>{var u=rt(),m=H(u);D(m,()=>Ct,(_,M)=>{M(_,{class:"text-2xl",children:(v,f)=>{st();var E=Dt("Average Mood");i(v,E)},$$slots:{default:!0}})}),i(O,u)},$$slots:{default:!0}})});var Y=d(W,2);D(Y,()=>Tt,(z,K)=>{K(z,{children:(O,x)=>{var u=rt(),m=H(u);{var _=v=>{var f=me(),E=r(f);{let F=y(Xt),B=y(()=>[new tt(t(p)[0]),new tt(t(p)[1])]),dt=y(Vt);Ot(E,{get data(){return t(J)},x:"date",get xScale(){return t(F)},get xDomain(){return t(B)},y:"averageMood",get yScale(){return t(dt)},yDomain:[-10,10],padding:{top:16,bottom:32,left:48,right:16},children:(ot,ft)=>{qt(ot,{children:(it,gt)=>{var xt=ue(),_t=H(xt);wt(_t,{placement:"left",grid:!0,rule:!1,ticks:[-10,-5,0,5,10],format:U=>{const S=Math.round(U);return S>0?`+${S}`:String(S)},class:"text-xs text-muted-foreground"});var ht=d(_t,2);{let U=y(()=>t(a)==="week"?7:6);wt(ht,{placement:"bottom",rule:!1,get ticks(){return t(U)},format:S=>t(a)==="week"||t(a)==="month"?S.toLocaleDateString("en-GB",{month:"short",day:"numeric"}):S.toLocaleDateString("en-GB",{month:"short",day:"numeric"}),class:"text-xs text-muted-foreground"})}var pt=d(ht,2);Jt(pt,{get curve(){return Qt},class:"fill-none stroke-[#485e92] stroke-2"});var At=d(pt,2);{const U=(S,lt)=>{let V=()=>lt?.().data;var vt=ce(),ct=r(vt),Ft=r(ct,!0);e(ct);var ut=d(ct,2),bt=d(r(ut),2),Ht=r(bt);e(bt),e(ut);var yt=d(ut,2),Nt=r(yt);e(yt),e(vt),q((jt,Gt)=>{w(Ft,jt),w(Ht,`Avg Mood: ${V().averageMood>0?"+":""}${Gt??""}`),w(Nt,`${V().entryCount??""}
                        ${V().entryCount===1?"entry":"entries"}`)},[()=>V().date.toLocaleDateString("en-GB",{month:"short",day:"numeric",year:"numeric"}),()=>V().averageMood.toFixed(1)]),i(S,vt)};D(At,()=>Ut,(S,lt)=>{lt(S,{variant:"none",children:U,$$slots:{default:!0}})})}i(it,xt)},$$slots:{default:!0}})},$$slots:{default:!0}})}e(f),i(v,f)},M=v=>{var f=fe();i(v,f)};et(m,v=>{t(J).length>0?v(_):v(M,!1)})}i(O,u)},$$slots:{default:!0}})}),i(n,l)},$$slots:{default:!0}})}),e(A);var Q=d(A,2);ee(Q,{currentTab:"insights"}),e(T),q(()=>{Z($,1,`rounded-lg border border-[#c5c6d0] px-3 py-1.5 text-sm font-medium transition-colors ${t(a)==="week"?"bg-[#d9dff6] text-[#404659]":"bg-white text-[#44464f] hover:bg-gray-50"}`),Z(c,1,`rounded-lg border border-[#c5c6d0] px-3 py-1.5 text-sm font-medium transition-colors ${t(a)==="month"?"bg-[#d9dff6] text-[#404659]":"bg-white text-[#44464f] hover:bg-gray-50"}`),Z(b,1,`rounded-lg border border-[#c5c6d0] px-3 py-1.5 text-sm font-medium transition-colors ${t(a)==="3months"?"bg-[#d9dff6] text-[#404659]":"bg-white text-[#44464f] hover:bg-gray-50"}`),Z(P,1,`rounded-lg border border-[#c5c6d0] px-3 py-1.5 text-sm font-medium transition-colors ${t(a)==="year"?"bg-[#d9dff6] text-[#404659]":"bg-white text-[#44464f] hover:bg-gray-50"}`)}),i(nt,T),Mt()}It(["click"]);export{Se as component};
