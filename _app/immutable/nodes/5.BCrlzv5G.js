import{d as ze,f as w,a as c,t as ie,c as me}from"../chunks/-oWnhBs4.js";import{s as j,h as pe,i as Le,g as e,b as p,j as R,p as Ee,a as Pe,e as v,d as u,t as W,c as Ae,k as Be,$ as Ne,r as f,u as m,m as F,n as Ie}from"../chunks/DxSztoeM.js";import{s as G}from"../chunks/CDp-2XP4.js";import{e as Re,N as Fe,l as Ge}from"../chunks/NkKpogXM.js";import{i as xe}from"../chunks/BRMXUoVx.js";import{c as D}from"../chunks/CRSDCZzM.js";import{h as He}from"../chunks/Xz8gqZgc.js";import{s as H}from"../chunks/knLRfhgA.js";import{C as Ye,a as je,b as Ke,c as Oe,d as We,S as qe,A as _e,e as Je,f as Qe,T as Ue,g as Ve,l as Xe,t as Ze}from"../chunks/Cls0rU7X.js";import{g as et}from"../chunks/C5L_nBhu.js";import{S as Y,m as tt}from"../chunks/5rMNgj8y.js";import{S as rt}from"../chunks/CVEBjHpG.js";class be extends Map{#e=new Map;#t=j(0);#r=j(0);#o=pe||-1;constructor(r){if(super(),r){for(var[t,a]of r)super.set(t,a);this.#r.v=super.size}}#s(r){return pe===this.#o?j(r):Le(r)}has(r){var t=this.#e,a=t.get(r);if(a===void 0){var d=super.get(r);if(d!==void 0)a=this.#s(0),t.set(r,a);else return e(this.#t),!1}return e(a),!0}forEach(r,t){this.#a(),super.forEach(r,t)}get(r){var t=this.#e,a=t.get(r);if(a===void 0){var d=super.get(r);if(d!==void 0)a=this.#s(0),t.set(r,a);else{e(this.#t);return}}return e(a),super.get(r)}set(r,t){var a=this.#e,d=a.get(r),y=super.get(r),b=super.set(r,t),S=this.#t;if(d===void 0)d=this.#s(0),a.set(r,d),p(this.#r,super.size),R(S);else if(y!==t){R(d);var K=S.reactions===null?null:new Set(S.reactions),T=K===null||!d.reactions?.every(z=>K.has(z));T&&R(S)}return b}delete(r){var t=this.#e,a=t.get(r),d=super.delete(r);return a!==void 0&&(t.delete(r),p(this.#r,super.size),p(a,-1),R(this.#t)),d}clear(){if(super.size!==0){super.clear();var r=this.#e;p(this.#r,0);for(var t of r.values())p(t,-1);R(this.#t),r.clear()}}#a(){e(this.#t);var r=this.#e;if(this.#r.v!==r.size){for(var t of super.keys())if(!r.has(t)){var a=this.#s(0);r.set(t,a)}}for([,a]of this.#e)e(a)}keys(){return e(this.#t),super.keys()}values(){return this.#a(),super.values()}entries(){return this.#a(),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return e(this.#r),super.size}}var st=w('<button type="button"><!> <span> </span></button>'),at=w("<!> <!>",1),ot=w('<div class="rounded-lg border border-border/50 bg-background px-3 py-2 text-xs shadow-xl"><div class="font-medium"> </div> <div class="mt-1 flex items-center gap-2"><div class="h-2 w-2 rounded-full bg-[#485e92]"></div> <span class="text-muted-foreground"> </span></div> <div class="mt-0.5 text-[10px] text-muted-foreground"> </div></div>'),nt=w("<!> <!> <!> <!>",1),it=w('<div class="h-[300px] w-full"><!></div>'),dt=w('<div class="flex h-[300px] w-full items-center justify-center text-sm text-muted-foreground">No mood entries found for the selected criteria</div>'),lt=w("<!> <!>",1),ut=w('<div class="flex h-screen flex-col bg-white"><main class="flex flex-1 flex-col gap-6 overflow-y-auto px-4 py-4"><div class="flex flex-wrap gap-2 py-2"><button type="button">Week</button> <button type="button">Month</button> <button type="button">3 Months</button> <button type="button">Year</button></div> <div class="flex flex-wrap gap-2"></div> <!></main> <!></div>');function St(de,r){Ee(r,!0);let t=j("3months"),a=j(Pe(new Set));const d=m(()=>{const n=new Date,o=new Y(n);o.setHours(23,59,59,999);const s=new Y(n);switch(e(t)){case"week":s.setDate(n.getDate()-7);break;case"month":s.setMonth(n.getMonth()-1);break;case"3months":s.setMonth(n.getMonth()-3);break;case"year":s.setFullYear(n.getFullYear()-1);break}return s.setHours(0,0,0,0),{start:s,end:o}}),y=m(()=>tt.allEntries.filter(n=>n.date>=e(d).start&&n.date<=e(d).end?e(a).size===0?!0:n.labels.some(s=>e(a).has(s.id)):!1)),b=m(()=>{if(e(y).length===0)return[];if(e(t)==="week"||e(t)==="month"){const o=new be;return e(y).forEach(s=>{const i=s.date.toISOString().split("T")[0];o.has(i)||o.set(i,[]),o.get(i).push(s)}),Array.from(o.entries()).map(([s,i])=>{const l=i.reduce((x,$)=>x+$.moodLevel,0)/i.length;return{date:new Date(s+"T12:00:00"),averageMood:l,entryCount:i.length}}).sort((s,i)=>s.date.getTime()-i.date.getTime())}else{const o=new be;return e(y).forEach(s=>{const i=new Y(s.date);i.setDate(s.date.getDate()-s.date.getDay()),i.setHours(0,0,0,0);const l=i.toISOString().split("T")[0];o.has(l)||o.set(l,[]),o.get(l).push(s)}),Array.from(o.entries()).map(([s,i])=>{const l=i.reduce((x,$)=>x+$.moodLevel,0)/i.length;return{date:new Date(s+"T12:00:00"),averageMood:l,entryCount:i.length}}).sort((s,i)=>s.date.getTime()-i.date.getTime())}}),S=m(()=>e(b).length===0?[e(d).start,e(d).end]:[e(d).start,e(d).end]);function K(n){const o=new rt(e(a));o.has(n)?o.delete(n):o.add(n),p(a,o,!0)}var T=ut();He("u6zn5i",n=>{Be(()=>{Ne.title="Insights - MoodLog"})});var z=v(T),q=v(z),J=v(q);J.__click=()=>p(t,"week");var Q=u(J,2);Q.__click=()=>p(t,"month");var U=u(Q,2);U.__click=()=>p(t,"3months");var le=u(U,2);le.__click=()=>p(t,"year"),f(q);var V=u(q,2);Re(V,21,()=>Ge.all,n=>n.id,(n,o)=>{const s=m(()=>et(e(o).icon)),i=m(()=>e(a).has(e(o).id));var l=st();l.__click=()=>K(e(o).id);var x=v(l);D(x,()=>e(s),(E,P)=>{P(E,{class:"h-4 w-4",strokeWidth:2})});var $=u(x,2),L=v($,!0);f($),f(l),W(()=>{H(l,1,`flex items-center gap-2 rounded-lg border border-[#c5c6d0] px-3 py-1.5 text-sm font-medium transition-colors ${e(i)?"bg-[#d9dff6] text-[#404659]":"bg-white text-[#44464f] hover:bg-gray-50"}`),G(L,e(o).name)}),c(n,l)}),f(V);var $e=u(V,2);D($e,()=>Ve,(n,o)=>{o(n,{class:"w-full",children:(s,i)=>{var l=lt(),x=F(l);D(x,()=>Ye,(L,E)=>{E(L,{children:(P,ye)=>{var A=at(),O=F(A);D(O,()=>je,(B,g)=>{g(B,{class:"text-2xl",children:(_,Z)=>{Ie();var M=ie("Average Mood");c(_,M)},$$slots:{default:!0}})});var X=u(O,2);D(X,()=>Ke,(B,g)=>{g(B,{children:(_,Z)=>{var M=me(),ee=F(M);{var te=k=>{var C=ie();W(()=>G(C,`Showing ${e(b).length??""} data ${e(b).length===1?"point":"points"} with ${e(y).length??""}
            ${e(y).length===1?"entry":"entries"}`)),c(k,C)},re=k=>{var C=ie("No mood entries found for the selected criteria");c(k,C)};xe(ee,k=>{e(b).length>0?k(te):k(re,!1)})}c(_,M)},$$slots:{default:!0}})}),c(P,A)},$$slots:{default:!0}})});var $=u(x,2);D($,()=>Oe,(L,E)=>{E(L,{children:(P,ye)=>{var A=me(),O=F(A);{var X=g=>{var _=it(),Z=v(_);{let M=m(Ze),ee=m(()=>[new Y(e(S)[0]),new Y(e(S)[1])]),te=m(Xe);We(Z,{get data(){return e(b)},x:"date",get xScale(){return e(M)},get xDomain(){return e(ee)},y:"averageMood",get yScale(){return e(te)},yDomain:[-10,10],padding:{top:16,bottom:32,left:48,right:16},children:(re,k)=>{qe(re,{children:(C,ct)=>{var ue=nt(),ce=F(ue);_e(ce,{placement:"left",grid:!0,rule:!1,ticks:[-10,-5,0,5,10],format:N=>{const h=Math.round(N);return h>0?`+${h}`:String(h)},class:"text-xs text-muted-foreground"});var fe=u(ce,2);{let N=m(()=>e(t)==="week"?7:6);_e(fe,{placement:"bottom",rule:!1,get ticks(){return e(N)},format:h=>e(t)==="week"||e(t)==="month"?h.toLocaleDateString("en-GB",{month:"short",day:"numeric"}):h.toLocaleDateString("en-GB",{month:"short",day:"numeric"}),class:"text-xs text-muted-foreground"})}var ve=u(fe,2);Je(ve,{get curve(){return Qe},class:"fill-none stroke-[#485e92] stroke-2"});var Se=u(ve,2);{const N=(h,se)=>{let I=()=>se?.().data;var ae=ot(),oe=v(ae),ke=v(oe,!0);f(oe);var ne=u(oe,2),ge=u(v(ne),2),De=v(ge);f(ge),f(ne);var he=u(ne,2),Me=v(he);f(he),f(ae),W((Ce,Te)=>{G(ke,Ce),G(De,`Avg Mood: ${I().averageMood>0?"+":""}${Te??""}`),G(Me,`${I().entryCount??""}
                        ${I().entryCount===1?"entry":"entries"}`)},[()=>I().date.toLocaleDateString("en-GB",{month:"short",day:"numeric",year:"numeric"}),()=>I().averageMood.toFixed(1)]),c(h,ae)};D(Se,()=>Ue,(h,se)=>{se(h,{variant:"none",children:N,$$slots:{default:!0}})})}c(C,ue)},$$slots:{default:!0}})},$$slots:{default:!0}})}f(_),c(g,_)},B=g=>{var _=dt();c(g,_)};xe(O,g=>{e(b).length>0?g(X):g(B,!1)})}c(P,A)},$$slots:{default:!0}})}),c(s,l)},$$slots:{default:!0}})}),f(z);var we=u(z,2);Fe(we,{currentTab:"insights"}),f(T),W(()=>{H(J,1,`rounded-lg border border-[#c5c6d0] px-3 py-1.5 text-sm font-medium transition-colors ${e(t)==="week"?"bg-[#d9dff6] text-[#404659]":"bg-white text-[#44464f] hover:bg-gray-50"}`),H(Q,1,`rounded-lg border border-[#c5c6d0] px-3 py-1.5 text-sm font-medium transition-colors ${e(t)==="month"?"bg-[#d9dff6] text-[#404659]":"bg-white text-[#44464f] hover:bg-gray-50"}`),H(U,1,`rounded-lg border border-[#c5c6d0] px-3 py-1.5 text-sm font-medium transition-colors ${e(t)==="3months"?"bg-[#d9dff6] text-[#404659]":"bg-white text-[#44464f] hover:bg-gray-50"}`),H(le,1,`rounded-lg border border-[#c5c6d0] px-3 py-1.5 text-sm font-medium transition-colors ${e(t)==="year"?"bg-[#d9dff6] text-[#404659]":"bg-white text-[#44464f] hover:bg-gray-50"}`)}),c(de,T),Ae()}ze(["click"]);export{St as component};
