import{p as Bt,f as W,a as M,c as V,d as At,t as Nt,e as Ot,s as st}from"./CL1gL8u8.js";import{p as at,g as e,u as s,m as T,f as S,c as nt,q as zt,h as L,r as E,t as ut,o as Yt,b as kt,s as Ft,Q as bt}from"./Dd77Lb4Z.js";import{i as rt}from"./9XiK6310.js";import{a as Rt,e as ft,i as wt,b as I}from"./BF1pAsR3.js";import{p as N,s as ot,r as xt,c as et}from"./Dvhy9Jzs.js";import{d as Xt,c as It,e as Vt,a as jt,i as Wt,S as Lt,M as lt,b as dt,f as ct,g as qt,C as Ht,p as Kt,h as Mt,j as Qt,k as Ct,l as Zt,m as Jt,n as Ut,o as pt,q as $t,A as St,r as te,T as ee,s as re,t as ae,u as ne}from"./ChxcPS2s.js";import{S as it}from"./UajU_CNF.js";import{C as ie,M as se}from"./G0fwheEy.js";import{m as oe}from"./CE2ydpzQ.js";import{C as ce}from"./DzAlfEna.js";class Et{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function le(n){return new Et(n,!0)}function de(n){return new Et(n,!1)}function Gt(n,t){return Math.abs(n.x-t.x)<1e-6&&Math.abs(n.y-t.y)<1e-6}function ue(n,t){return Gt(n,t)?"":`M ${n.x} ${n.y} L ${t.x} ${t.y}`}function j(n){return Math.abs(n)<1e-6}function yt({source:n,target:t,sweep:r}){return r==="horizontal-vertical"?`M ${n.x} ${n.y} L ${t.x} ${n.y} L ${t.x} ${t.y}`:`M ${n.x} ${n.y} L ${n.x} ${t.y} L ${t.x} ${t.y}`}function fe(n){const{radius:t,dx:r,dy:x,source:c,target:l,sweep:v}=n,i=Math.max(0,Math.min(t,Math.abs(r),Math.abs(x)));if(j(i))return yt(n);const y=Math.sign(r),m=Math.sign(x);if(v==="horizontal-vertical"){const f={x:l.x-i*y,y:c.y},u={x:l.x,y:c.y+i*m};return`M ${c.x} ${c.y} L ${f.x} ${f.y} L ${u.x} ${u.y} L ${l.x} ${l.y}`}else{const f={x:c.x,y:l.y-i*m},u={x:c.x+i*y,y:l.y};return`M ${c.x} ${c.y} L ${f.x} ${f.y} L ${u.x} ${u.y} L ${l.x} ${l.y}`}}function xe(n){const{radius:t,dx:r,dy:x,source:c,target:l,sweep:v}=n,i=Math.max(0,Math.min(t,Math.abs(r),Math.abs(x)));if(j(i))return yt(n);const y=Math.sign(r),m=Math.sign(x);if(v==="horizontal-vertical"){const f={x:l.x-i*y,y:c.y},u={x:l.x,y:c.y+i*m},P=y*m>0?1:0;return`M ${c.x} ${c.y} L ${f.x} ${f.y} A ${i} ${i} 0 0 ${P} ${u.x} ${u.y} L ${l.x} ${l.y}`}else{const f={x:c.x,y:l.y-i*m},u={x:c.x+i*y,y:l.y},P=y*m>0?0:1;return`M ${c.x} ${c.y} L ${f.x} ${f.y} A ${i} ${i} 0 0 ${P} ${u.x} ${u.y} L ${l.x} ${l.y}`}}const Pt={square:yt,beveled:fe,rounded:xe};function ye(n){const{source:t,target:r,type:x}=n;if(Gt(t,r))return"";const c=r.x-t.x,l=r.y-t.y;return x==="straight"||j(c)||j(l)?ue(t,r):(Pt[x]||Pt.square)({...n,dx:c,dy:l})}const Dt="M0,0L0,0";function ve({source:n,target:t,sweep:r,curve:x}){const c=t.x-n.x,l=t.y-n.y,v=Xt().curve(x);let i=[];const y=j(c)||j(l);if(r==="none"||y?i=[[n.x,n.y],[t.x,t.y]]:r==="horizontal-vertical"?i=[[n.x,n.y],[t.x,n.y],[t.x,t.y]]:r==="vertical-horizontal"&&(i=[[n.x,n.y],[n.x,t.y],[t.x,t.y]]),i.length===2&&j(c)&&j(c))return Dt;const m=v(i);return!m||m.includes("NaN")?Dt:m}var he=W("<!> <!> <!> <!>",1);function ge(n,t){const r=Bt();at(t,!0);let x=N(t,"source",19,()=>({x:0,y:0})),c=N(t,"target",19,()=>({x:100,y:100})),l=N(t,"type",3,"rounded"),v=N(t,"radius",3,20),i=N(t,"curve",3,It),y=N(t,"pathRef",15),m=xt(t,["$$slots","$$events","$$legacy","source","target","sweep","type","radius","curve","pathRef","pathData","marker","markerStart","markerMid","markerEnd","motion"]);const f=s(()=>t.sweep?t.sweep:l()==="d3"?"none":"horizontal-vertical"),u=s(()=>t.markerStart||t.marker?dt("marker-start",r):""),P=s(()=>t.markerMid||t.marker?dt("marker-mid",r):""),D=s(()=>t.markerEnd||t.marker?dt("marker-end",r):""),a=Vt(t.motion),k=a?{type:a.type,options:{interpolate:Wt,...a.options}}:void 0,C=s(()=>t.pathData?t.pathData:l()==="d3"?ve({source:x(),target:c(),sweep:e(f),curve:i()}):ye({source:x(),target:c(),sweep:e(f),type:l(),radius:v()})),o=jt("",()=>e(C),k||{type:"none"});var d=he(),h=T(d);{let w=s(()=>e(u)?`url(#${e(u)})`:void 0),A=s(()=>e(P)?`url(#${e(P)})`:void 0),z=s(()=>e(D)?`url(#${e(D)})`:void 0),G=s(()=>ct(m,"connector"));Lt(h,ot({get pathData(){return o.current},get"marker-start"(){return e(w)},get"marker-mid"(){return e(A)},get"marker-end"(){return e(z)}},()=>e(G),()=>m,{get pathRef(){return y()},set pathRef(R){y(R)}}))}var _=S(h,2);lt(_,{get id(){return e(u)},get marker(){return t.markerStart}});var g=S(_,2);lt(g,{get id(){return e(P)},get marker(){return t.markerMid}});var b=S(g,2);lt(b,{get id(){return e(D)},get marker(){return t.markerEnd}}),M(n,d),nt()}const J={x:0,y:0};function me(n,t){at(t,!0);let r=N(t,"sankey",3,!1),x=N(t,"type",3,"d3"),c=N(t,"sweep",3,"none"),l=xt(t,["$$slots","$$events","$$legacy","data","sankey","source","target","orientation","x","y","curve","explicitCoords","type","sweep"]);const v=s(()=>t.source?t.source:r()?a=>({node:a.source,y:a.y0,isSource:!0}):a=>a.source),i=s(()=>t.target?t.target:r()?a=>({node:a.target,y:a.y1,isSource:!1}):a=>a.target),y=s(()=>t.orientation?t.orientation:r()?"horizontal":"vertical"),m=s(()=>t.curve?t.curve:e(y)==="horizontal"?le:de),f=s(()=>t.x?t.x:r()?a=>a.isSource?a.node.x1:a.node.x0:a=>e(y)==="horizontal"?a.y:a.x),u=s(()=>t.y?t.y:r()?a=>a.y:a=>e(y)==="horizontal"?a.x:a.y),P=s(()=>{if(t.explicitCoords)return{x:t.explicitCoords.x1,y:t.explicitCoords.y1};if(!t.data)return J;try{const a=e(v)(t.data);if(a==null)return J;const k=e(f)(a),C=e(u)(a);return{x:Number.isFinite(k)?k:0,y:Number.isFinite(C)?C:0}}catch(a){return console.error("Error accessing source coordinates:",a,"Data:",t.data),J}}),D=s(()=>{if(t.explicitCoords)return{x:t.explicitCoords.x2,y:t.explicitCoords.y2};if(!t.data)return J;try{const a=e(i)(t.data);if(a==null)return J;const k=e(f)(a),C=e(u)(a);return{x:Number.isFinite(k)?k:0,y:Number.isFinite(C)?C:0}}catch(a){return console.error("Error accessing target coordinates:",a,"Data:",t.data),J}});{let a=s(()=>ct(l,"link"));ge(n,ot({get source(){return e(P)},get target(){return e(D)},get type(){return x()},get curve(){return e(m)},get sweep(){return c()}},()=>e(a)))}nt()}var _e=W("<!> <!>",1);function ke(n,t){at(t,!0);const r=qt();let x=N(t,"r",3,5),c=N(t,"links",3,!1),l=xt(t,["$$slots","$$events","$$legacy","data","x","y","r","offsetX","offsetY","links","fill","fillOpacity","stroke","strokeWidth","opacity","children"]);function v(o,d,h){return typeof d=="function"?d(o,r):d??(Qt(h)&&!r.radial?h.bandwidth()/2:0)}const i=s(()=>t.x?Mt(t.x):r.x),y=s(()=>t.y?Mt(t.y):r.y),m=s(()=>t.data??r.data),f=(o,d,h)=>{const _=r.xScale(o),g=r.yScale(d);return{x:_+v(_,t.offsetX,r.xScale),y:g+v(g,t.offsetY,r.yScale),r:r.config.r?r.rGet(h):x(),xValue:o,yValue:d,data:h}},u=s(()=>e(m).flatMap(o=>{const d=e(i)(o),h=e(y)(o);return Array.isArray(d)?d.filter(Boolean).map(_=>f(_,h,o)):Array.isArray(h)?h.filter(Boolean).map(_=>f(d,_,o)):d!=null&&h!=null?f(d,h,o):[]})),P=s(()=>e(m).flatMap(o=>{const d=e(i)(o),h=e(y)(o);if(Array.isArray(d)){const[_,g]=Ct(r.xGet(o)),b=r.yGet(o)+v(r.yGet(o),t.offsetY,r.yScale);return{source:{x:_+v(_,t.offsetX,r.xScale)+(r.config.r?r.rGet(o):x()),y:b},target:{x:g+v(g,t.offsetX,r.xScale)-(r.config.r?r.rGet(o):x()),y:b},data:o}}else if(Array.isArray(h)){const _=r.xGet(o)+v(r.xGet(o),t.offsetX,r.xScale),[g,b]=Ct(r.yGet(o));return{source:{x:_,y:g+v(g,t.offsetY,r.yScale)},target:{x:_,y:b+v(b,t.offsetY,r.yScale)},data:o}}}));var D=V(),a=T(D);{var k=o=>{var d=V(),h=T(d);Rt(h,()=>t.children,()=>({points:e(u)})),M(o,d)},C=o=>{var d=_e(),h=T(d);{var _=b=>{var w=V(),A=T(w);ft(A,17,()=>e(P),wt,(z,G)=>{{let R=s(()=>t.fill??(r.config.c?r.cGet(e(G).data):null)),B=s(()=>ct(c(),"points-link"));me(z,ot({get data(){return e(G)},get stroke(){return e(R)}},()=>e(B)))}}),M(b,w)};rt(h,b=>{c()&&b(_)})}var g=S(h,2);ft(g,17,()=>e(u),wt,(b,w)=>{const A=s(()=>Kt(e(w).x,e(w).y));{let z=s(()=>r.radial?e(A)[0]:e(w).x),G=s(()=>r.radial?e(A)[1]:e(w).y),R=s(()=>t.fill??(r.config.c?r.cGet(e(w).data):null)),B=s(()=>ct(l,"point"));Ht(b,ot({get cx(){return e(z)},get cy(){return e(G)},get r(){return e(w).r},get fill(){return e(R)},get fillOpacity(){return t.fillOpacity},get stroke(){return t.stroke},get strokeWidth(){return t.strokeWidth},get opacity(){return t.opacity}},()=>e(B)))}}),M(o,d)};rt(a,o=>{t.children?o(k):o(C,!1)})}M(n,D),nt()}var be=Ot('<g role="button" tabindex="0" class="cursor-pointer"><circle r="24" fill="transparent" class="touch-manipulation"></circle><circle fill="#485e92" class="group-active:r-[8] pointer-events-none transition-all duration-200"></circle></g>'),we=W('<div class="rounded-lg border border-border/50 bg-background px-3 py-2 text-xs shadow-xl"><div class="font-medium"> </div> <div class="mt-1 flex items-center gap-2"><div class="h-2 w-2 rounded-full bg-[#485e92]"></div> <span class="text-muted-foreground"> </span></div> <div class="mt-0.5 text-[10px] text-muted-foreground"> </div></div>'),Me=W("<!> <!> <!> <!> <!>",1),Ce=W('<div class="h-[300px] w-full"><!></div>'),Se=W('<div class="flex h-[300px] w-full items-center justify-center text-sm text-muted-foreground">No mood entries for this day</div>'),Pe=W("<!> <!>",1);function De(n,t){at(t,!0);const r=s(()=>t.entries.length===0?[]:[...t.entries].sort((i,y)=>i.date.getTime()-y.date.getTime()).map(i=>({date:i.date,mood:i.moodLevel,id:i.id,title:i.title,isSelected:i.id===t.selectedEntryId}))),x=s(()=>{if(e(r).length===0){const m=new Date,f=new it(m);f.setHours(0,0,0,0);const u=new it(m);return u.setHours(24,0,0,0),[f,u]}const v=e(r)[0].date,i=new it(v);i.setHours(0,0,0,0);const y=new it(v);return y.setHours(24,0,0,0),[i,y]});var c=V(),l=T(c);et(l,()=>re,(v,i)=>{i(v,{class:"w-full",children:(y,m)=>{var f=Pe(),u=T(f);et(u,()=>Zt,(D,a)=>{a(D,{children:(k,C)=>{var o=V(),d=T(o);et(d,()=>Jt,(h,_)=>{_(h,{children:(g,b)=>{zt();var w=Nt("Daily Mood Overview");M(g,w)},$$slots:{default:!0}})}),M(k,o)},$$slots:{default:!0}})});var P=S(u,2);et(P,()=>Ut,(D,a)=>{a(D,{children:(k,C)=>{var o=V(),d=T(o);{var h=g=>{var b=Ce(),w=L(b);{let A=s(ae),z=s(ne);pt(w,{get data(){return e(r)},x:"date",get xScale(){return e(A)},get xDomain(){return e(x)},y:"mood",get yScale(){return e(z)},yDomain:[-10,10],padding:{top:16,bottom:32,left:48,right:16},children:(G,R)=>{$t(G,{children:(B,Le)=>{var vt=Me(),ht=T(vt);St(ht,{placement:"left",grid:!0,rule:!1,ticks:[-10,0,10],format:H=>{const O=Math.round(H);return O>=7?"Good":O<=-7?"Bad":O>=-3&&O<=3?"Neutral":""},class:"text-xs text-muted-foreground"});var gt=S(ht,2);St(gt,{placement:"bottom",rule:!1,ticks:13,format:H=>H.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1}),class:"text-xs text-muted-foreground"});var mt=S(gt,2);Lt(mt,{get curve(){return te},class:"fill-none stroke-[#485e92] stroke-2"});var _t=S(mt,2);ke(_t,{r:4,fill:"#485e92",children:(O,U)=>{let K=()=>U?.().points;var Q=V(),p=T(Q);ft(p,17,K,$=>$.data.id,($,Y)=>{const F=s(()=>e(Y).data);var X=be();X.__click=()=>t.onPointClick?.(e(F).id),X.__keydown=tt=>{(tt.key==="Enter"||tt.key===" ")&&(tt.preventDefault(),t.onPointClick?.(e(F).id))};var Z=L(X),q=S(Z);E(X),ut(()=>{I(X,"aria-label",`Select entry: ${e(F).title??""}`),I(Z,"cx",e(Y).x),I(Z,"cy",e(Y).y),I(q,"cx",e(Y).x),I(q,"cy",e(Y).y),I(q,"r",e(F).isSelected?9:4),I(q,"stroke",e(F).isSelected?"white":"none"),I(q,"stroke-width",e(F).isSelected?3:0)}),M($,X)}),M(O,Q)},$$slots:{default:!0}});var Tt=S(_t,2);{const H=(O,U)=>{let K=()=>U?.().data;var Q=we(),p=L(Q),$=L(p,!0);E(p);var Y=S(p,2),F=S(L(Y),2),X=L(F);E(F),E(Y);var Z=S(Y,2),q=L(Z,!0);E(Z),E(Q),ut(tt=>{st($,K().title),st(X,`Mood: ${K().mood>0?"+":""}${K().mood??""}`),st(q,tt)},[()=>K().date.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1})]),M(O,Q)};et(Tt,()=>ee,(O,U)=>{U(O,{variant:"none",children:H,$$slots:{default:!0}})})}M(B,vt)},$$slots:{default:!0}})},$$slots:{default:!0}})}E(b),M(g,b)},_=g=>{var b=Se();M(g,b)};rt(d,g=>{e(r).length>0?g(h):g(_,!1)})}M(k,o)},$$slots:{default:!0}})}),M(y,f)},$$slots:{default:!0}})}),M(n,c),nt()}At(["click","keydown"]);var Ae=W('<div class="flex w-full flex-col gap-4"><div class="w-full"><!></div> <!> <div class="flex w-full items-center justify-between"><p class="text-sm text-gray-600"> </p> <div class="flex gap-1.5"><button type="button" class="flex h-12 w-[52px] items-center justify-center rounded-full bg-[#d9dff6] transition-colors hover:bg-[#c5cbe8] disabled:cursor-not-allowed disabled:opacity-50" aria-label="Previous entry"><!></button> <button type="button" class="flex h-12 w-[52px] items-center justify-center rounded-full bg-[#d9dff6] transition-colors hover:bg-[#c5cbe8] disabled:cursor-not-allowed disabled:opacity-50" aria-label="Next entry"><!></button></div></div></div>');function Xe(n,t){at(t,!0);let r=Ft(0);const x=s(()=>oe.entries.filter(a=>a.date.getDate()===t.date.getDate()&&a.date.getMonth()===t.date.getMonth()&&a.date.getFullYear()===t.date.getFullYear()).sort((a,k)=>a.date.getTime()-k.date.getTime())),c=s(()=>e(x)[e(r)]),l=s(()=>e(x).length>0),v=s(()=>e(r)>0),i=s(()=>e(r)<e(x).length-1);function y(){e(v)&&bt(r,-1)}function m(){e(i)&&bt(r)}function f(a){const k=e(x).findIndex(C=>C.id===a);k!==-1&&kt(r,k,!0)}Yt(()=>{t.date,kt(r,0)});var u=V(),P=T(u);{var D=a=>{var k=Ae(),C=L(k),o=L(C);{let B=s(()=>e(c)?.id);De(o,{get entries(){return e(x)},get selectedEntryId(){return e(B)},onPointClick:f})}E(C);var d=S(C,2);{var h=B=>{se(B,{get entry(){return e(c)},clickable:!1})};rt(d,B=>{e(c)&&B(h)})}var _=S(d,2),g=L(_),b=L(g);E(g);var w=S(g,2),A=L(w);A.__click=y;var z=L(A);ie(z,{class:"h-6 w-6 text-[#404659]",strokeWidth:2}),E(A);var G=S(A,2);G.__click=m;var R=L(G);ce(R,{class:"h-6 w-6 text-[#404659]",strokeWidth:2}),E(G),E(w),E(_),E(k),ut(()=>{st(b,`Entry ${e(r)+1} of ${e(x).length??""}`),A.disabled=!e(v),G.disabled=!e(i)}),M(a,k)};rt(P,a=>{e(l)&&a(D)})}M(n,u),nt()}At(["click"]);export{Xe as D};
